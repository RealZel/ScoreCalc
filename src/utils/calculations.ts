// WHO Child Growth Standards - Official LMS Data from CDC/WHO
// Data source: https://www.cdc.gov/growthcharts/who-data-files.htm
// Age is in MONTHS (0-24 months for most indicators)
//
// LMS Formula (from CDC):
// Z-score = ((X/M)^L - 1) / (L × S), when L ≠ 0
// Z-score = ln(X/M) / S, when L = 0
//
// Where:
// X = measured value (weight in kg, length in cm, head circ in cm)
// L = Box-Cox transformation power (Lambda)
// M = Median
// S = Generalized coefficient of variation (Sigma)

// ============================================================
// WEIGHT-FOR-AGE: Boys (0-24 months)
// ============================================================
export const weightForAgeBoys: Record<number, { L: number; M: number; S: number }> = {
  0: { L: 0.3487, M: 3.3464, S: 0.14602 },
  1: { L: 0.2297, M: 4.4709, S: 0.13395 },
  2: { L: 0.197, M: 5.5675, S: 0.12385 },
  3: { L: 0.1738, M: 6.3762, S: 0.11727 },
  4: { L: 0.1553, M: 7.0023, S: 0.11316 },
  5: { L: 0.1395, M: 7.5105, S: 0.1108 },
  6: { L: 0.1257, M: 7.934, S: 0.10958 },
  7: { L: 0.1134, M: 8.297, S: 0.10902 },
  8: { L: 0.1021, M: 8.6151, S: 0.10882 },
  9: { L: 0.0917, M: 8.9014, S: 0.10881 },
  10: { L: 0.082, M: 9.1649, S: 0.10891 },
  11: { L: 0.073, M: 9.4122, S: 0.10906 },
  12: { L: 0.0644, M: 9.6479, S: 0.10925 },
  13: { L: 0.0563, M: 9.8749, S: 0.10949 },
  14: { L: 0.0487, M: 10.0953, S: 0.10976 },
  15: { L: 0.0413, M: 10.3108, S: 0.11007 },
  16: { L: 0.0343, M: 10.5228, S: 0.11041 },
  17: { L: 0.0275, M: 10.7319, S: 0.11079 },
  18: { L: 0.0211, M: 10.9385, S: 0.11119 },
  19: { L: 0.0148, M: 11.143, S: 0.11164 },
  20: { L: 0.0087, M: 11.3462, S: 0.11211 },
  21: { L: 0.0029, M: 11.5486, S: 0.11261 },
  22: { L: -0.0028, M: 11.7504, S: 0.11314 },
  23: { L: -0.0083, M: 11.9514, S: 0.11369 },
  24: { L: -0.0137, M: 12.1515, S: 0.11426 },
};

// ============================================================
// WEIGHT-FOR-AGE: Girls (0-24 months)
// ============================================================
export const weightForAgeGirls: Record<number, { L: number; M: number; S: number }> = {
  0: { L: 0.3809, M: 3.2322, S: 0.14171 },
  1: { L: 0.1714, M: 4.1873, S: 0.13724 },
  2: { L: 0.0962, M: 5.1282, S: 0.13 },
  3: { L: 0.0402, M: 5.8458, S: 0.12619 },
  4: { L: -0.005, M: 6.4237, S: 0.12402 },
  5: { L: -0.043, M: 6.8985, S: 0.12274 },
  6: { L: -0.0756, M: 7.297, S: 0.12204 },
  7: { L: -0.1039, M: 7.6422, S: 0.12178 },
  8: { L: -0.1288, M: 7.9487, S: 0.12181 },
  9: { L: -0.1507, M: 8.2254, S: 0.12199 },
  10: { L: -0.17, M: 8.48, S: 0.12223 },
  11: { L: -0.1872, M: 8.7192, S: 0.12247 },
  12: { L: -0.2024, M: 8.9481, S: 0.12268 },
  13: { L: -0.2158, M: 9.1699, S: 0.12283 },
  14: { L: -0.2278, M: 9.387, S: 0.12294 },
  15: { L: -0.2384, M: 9.6008, S: 0.12299 },
  16: { L: -0.2478, M: 9.8124, S: 0.12303 },
  17: { L: -0.2562, M: 10.0226, S: 0.12306 },
  18: { L: -0.2637, M: 10.2315, S: 0.12309 },
  19: { L: -0.2703, M: 10.4393, S: 0.12315 },
  20: { L: -0.2762, M: 10.6464, S: 0.12323 },
  21: { L: -0.2815, M: 10.8534, S: 0.12335 },
  22: { L: -0.2862, M: 11.0608, S: 0.1235 },
  23: { L: -0.2903, M: 11.2688, S: 0.12369 },
  24: { L: -0.2941, M: 11.4775, S: 0.1239 },
};

// ============================================================
// LENGTH-FOR-AGE: Boys (0-24 months)
// ============================================================
export const lengthForAgeBoys: Record<number, { L: number; M: number; S: number }> = {
  0: { L: 1, M: 49.8842, S: 0.03795 },
  1: { L: 1, M: 54.7244, S: 0.03557 },
  2: { L: 1, M: 58.4249, S: 0.03424 },
  3: { L: 1, M: 61.4292, S: 0.03328 },
  4: { L: 1, M: 63.886, S: 0.03257 },
  5: { L: 1, M: 65.9026, S: 0.03204 },
  6: { L: 1, M: 67.6236, S: 0.03165 },
  7: { L: 1, M: 69.1645, S: 0.03139 },
  8: { L: 1, M: 70.5994, S: 0.03124 },
  9: { L: 1, M: 71.9687, S: 0.03117 },
  10: { L: 1, M: 73.2812, S: 0.03118 },
  11: { L: 1, M: 74.5388, S: 0.03125 },
  12: { L: 1, M: 75.7488, S: 0.03137 },
  13: { L: 1, M: 76.9186, S: 0.03154 },
  14: { L: 1, M: 78.0497, S: 0.03174 },
  15: { L: 1, M: 79.1458, S: 0.03197 },
  16: { L: 1, M: 80.2113, S: 0.03222 },
  17: { L: 1, M: 81.2487, S: 0.0325 },
  18: { L: 1, M: 82.2587, S: 0.03279 },
  19: { L: 1, M: 83.2418, S: 0.0331 },
  20: { L: 1, M: 84.1996, S: 0.03342 },
  21: { L: 1, M: 85.1348, S: 0.03376 },
  22: { L: 1, M: 86.0477, S: 0.0341 },
  23: { L: 1, M: 86.941, S: 0.03445 },
  24: { L: 1, M: 87.8161, S: 0.03479 },
};

// ============================================================
// LENGTH-FOR-AGE: Girls (0-24 months)
// ============================================================
export const lengthForAgeGirls: Record<number, { L: number; M: number; S: number }> = {
  0: { L: 1, M: 49.1477, S: 0.0379 },
  1: { L: 1, M: 53.6872, S: 0.0364 },
  2: { L: 1, M: 57.0673, S: 0.03568 },
  3: { L: 1, M: 59.8029, S: 0.0352 },
  4: { L: 1, M: 62.0899, S: 0.03486 },
  5: { L: 1, M: 64.0301, S: 0.03463 },
  6: { L: 1, M: 65.7311, S: 0.03448 },
  7: { L: 1, M: 67.2873, S: 0.03441 },
  8: { L: 1, M: 68.7498, S: 0.0344 },
  9: { L: 1, M: 70.1435, S: 0.03444 },
  10: { L: 1, M: 71.4818, S: 0.03452 },
  11: { L: 1, M: 72.771, S: 0.03464 },
  12: { L: 1, M: 74.015, S: 0.03479 },
  13: { L: 1, M: 75.2176, S: 0.03496 },
  14: { L: 1, M: 76.3817, S: 0.03514 },
  15: { L: 1, M: 77.5099, S: 0.03534 },
  16: { L: 1, M: 78.6055, S: 0.03555 },
  17: { L: 1, M: 79.671, S: 0.03576 },
  18: { L: 1, M: 80.7079, S: 0.03598 },
  19: { L: 1, M: 81.7182, S: 0.0362 },
  20: { L: 1, M: 82.7036, S: 0.03643 },
  21: { L: 1, M: 83.6654, S: 0.03666 },
  22: { L: 1, M: 84.6040, S: 0.03688 },
  23: { L: 1, M: 85.5202, S: 0.03711 },
  24: { L: 1, M: 86.4153, S: 0.03734 },
};

// ============================================================
// HEAD CIRCUMFERENCE-FOR-AGE: Boys (0-24 months)
// ============================================================
export const headCircForAgeBoys: Record<number, { L: number; M: number; S: number }> = {
  0: { L: 1, M: 34.4618, S: 0.03686 },
  1: { L: 1, M: 37.2759, S: 0.03133 },
  2: { L: 1, M: 39.1285, S: 0.02997 },
  3: { L: 1, M: 40.5135, S: 0.02918 },
  4: { L: 1, M: 41.6317, S: 0.02868 },
  5: { L: 1, M: 42.5576, S: 0.02837 },
  6: { L: 1, M: 43.3306, S: 0.02817 },
  7: { L: 1, M: 43.9803, S: 0.02804 },
  8: { L: 1, M: 44.53, S: 0.02796 },
  9: { L: 1, M: 44.9998, S: 0.02792 },
  10: { L: 1, M: 45.4051, S: 0.0279 },
  11: { L: 1, M: 45.7573, S: 0.02789 },
  12: { L: 1, M: 46.0661, S: 0.02789 },
  13: { L: 1, M: 46.3395, S: 0.02789 },
  14: { L: 1, M: 46.5844, S: 0.02791 },
  15: { L: 1, M: 46.806, S: 0.02792 },
  16: { L: 1, M: 47.0088, S: 0.02795 },
  17: { L: 1, M: 47.1962, S: 0.02797 },
  18: { L: 1, M: 47.3711, S: 0.028 },
  19: { L: 1, M: 47.5357, S: 0.02803 },
  20: { L: 1, M: 47.6919, S: 0.02806 },
  21: { L: 1, M: 47.8408, S: 0.0281 },
  22: { L: 1, M: 47.9833, S: 0.02813 },
  23: { L: 1, M: 48.1201, S: 0.02817 },
  24: { L: 1, M: 48.2515, S: 0.02821 },
};

// ============================================================
// HEAD CIRCUMFERENCE-FOR-AGE: Girls (0-24 months)
// ============================================================
export const headCircForAgeGirls: Record<number, { L: number; M: number; S: number }> = {
  0: { L: 1, M: 33.8787, S: 0.03496 },
  1: { L: 1, M: 36.5463, S: 0.0321 },
  2: { L: 1, M: 38.2521, S: 0.03168 },
  3: { L: 1, M: 39.5328, S: 0.0314 },
  4: { L: 1, M: 40.5817, S: 0.03119 },
  5: { L: 1, M: 41.459, S: 0.03102 },
  6: { L: 1, M: 42.1995, S: 0.03087 },
  7: { L: 1, M: 42.829, S: 0.03075 },
  8: { L: 1, M: 43.3671, S: 0.03063 },
  9: { L: 1, M: 43.83, S: 0.03053 },
  10: { L: 1, M: 44.2319, S: 0.03044 },
  11: { L: 1, M: 44.5844, S: 0.03035 },
  12: { L: 1, M: 44.8965, S: 0.03027 },
  13: { L: 1, M: 45.1752, S: 0.03019 },
  14: { L: 1, M: 45.4265, S: 0.03012 },
  15: { L: 1, M: 45.6551, S: 0.03006 },
  16: { L: 1, M: 45.865, S: 0.03 },
  17: { L: 1, M: 46.0598, S: 0.02994 },
  18: { L: 1, M: 46.2424, S: 0.02989 },
  19: { L: 1, M: 46.4152, S: 0.02984 },
  20: { L: 1, M: 46.5801, S: 0.02981 },
  21: { L: 1, M: 46.7384, S: 0.02978 },
  22: { L: 1, M: 46.8913, S: 0.02975 },
  23: { L: 1, M: 47.0391, S: 0.02973 },
  24: { L: 1, M: 47.1822, S: 0.02971 },
};

// ============================================================
// CDC BMI-FOR-AGE: Boys (24-240 months / 2-20 years)
// Source: https://www.cdc.gov/growthcharts/percentile_data_files.htm
// CDCref_d.csv - SEX=1 for boys
// ============================================================
export const bmiForAgeBoys: Record<number, { L: number; M: number; S: number }> = {
  24: { L: -1.982373595, M: 16.54777487, S: 0.080127429 },
  25: { L: -1.924100169, M: 16.49442763, S: 0.079233994 },
  26: { L: -1.86549793, M: 16.44259552, S: 0.078389356 },
  27: { L: -1.807261899, M: 16.3922434, S: 0.077593501 },
  28: { L: -1.750118905, M: 16.34333654, S: 0.076846462 },
  29: { L: -1.69481584, M: 16.29584097, S: 0.076148308 },
  30: { L: -1.642106779, M: 16.24972371, S: 0.075499126 },
  31: { L: -1.592744414, M: 16.20495268, S: 0.074898994 },
  32: { L: -1.547442391, M: 16.16149871, S: 0.074347997 },
  33: { L: -1.506902601, M: 16.11933258, S: 0.073846139 },
  34: { L: -1.471770047, M: 16.07842758, S: 0.07339337 },
  35: { L: -1.442628957, M: 16.03875896, S: 0.072989551 },
  36: { L: -1.419991255, M: 16.00030401, S: 0.072634432 },
  37: { L: -1.404277619, M: 15.96304277, S: 0.072327649 },
  38: { L: -1.39586317, M: 15.92695418, S: 0.07206864 },
  39: { L: -1.394935252, M: 15.89202582, S: 0.071856805 },
  40: { L: -1.401671596, M: 15.85824093, S: 0.071691278 },
  41: { L: -1.416100312, M: 15.82558822, S: 0.071571093 },
  42: { L: -1.438164899, M: 15.79405728, S: 0.071495113 },
  43: { L: -1.467669032, M: 15.76364255, S: 0.071462106 },
  44: { L: -1.504376347, M: 15.73433668, S: 0.071470646 },
  45: { L: -1.547942838, M: 15.70613566, S: 0.071519218 },
  46: { L: -1.597896397, M: 15.67904062, S: 0.071606277 },
  47: { L: -1.653732283, M: 15.65305192, S: 0.071730167 },
  48: { L: -1.714869347, M: 15.62817269, S: 0.071889214 },
  49: { L: -1.780673181, M: 15.604408, S: 0.072081737 },
  50: { L: -1.850468473, M: 15.58176458, S: 0.072306081 },
  51: { L: -1.923551865, M: 15.56025067, S: 0.072560637 },
  52: { L: -1.999220429, M: 15.5398746, S: 0.07284384 },
  53: { L: -2.076707178, M: 15.52064993, S: 0.073154324 },
  54: { L: -2.155348017, M: 15.50258427, S: 0.073490667 },
  55: { L: -2.234438552, M: 15.48568973, S: 0.073851672 },
  56: { L: -2.313321723, M: 15.46997718, S: 0.074236235 },
  57: { L: -2.391381273, M: 15.45545692, S: 0.074643374 },
  58: { L: -2.468032491, M: 15.44213961, S: 0.075072264 },
  59: { L: -2.542781541, M: 15.43003207, S: 0.075522104 },
  60: { L: -2.61516595, M: 15.41914163, S: 0.07599225 },
  61: { L: -2.684789516, M: 15.40947356, S: 0.076482128 },
  62: { L: -2.751316949, M: 15.40103139, S: 0.076991232 },
  63: { L: -2.81445945, M: 15.39381785, S: 0.077519149 },
  64: { L: -2.87402476, M: 15.38783094, S: 0.07806539 },
  65: { L: -2.92984048, M: 15.38306945, S: 0.078629592 },
  66: { L: -2.981796828, M: 15.37952958, S: 0.079211369 },
  67: { L: -3.029831343, M: 15.37720582, S: 0.079810334 },
  68: { L: -3.073924224, M: 15.37609107, S: 0.080426086 },
  69: { L: -3.114093476, M: 15.37617677, S: 0.081058206 },
  70: { L: -3.15039004, M: 15.37745304, S: 0.081706249 },
  71: { L: -3.182893018, M: 15.37990886, S: 0.082369741 },
  72: { L: -3.21170511, M: 15.38353217, S: 0.083048178 },
  73: { L: -3.23694834, M: 15.38831005, S: 0.083741021 },
  74: { L: -3.25876011, M: 15.39422883, S: 0.0844477 },
  75: { L: -3.277281546, M: 15.40127496, S: 0.085167651 },
  76: { L: -3.292683774, M: 15.40943252, S: 0.085900184 },
  77: { L: -3.305124073, M: 15.41868691, S: 0.086644667 },
  78: { L: -3.314768951, M: 15.42902273, S: 0.087400421 },
  79: { L: -3.321785992, M: 15.44042439, S: 0.088166744 },
  80: { L: -3.326345795, M: 15.45287581, S: 0.088942897 },
  81: { L: -3.328602731, M: 15.46636218, S: 0.089728202 },
  82: { L: -3.328725277, M: 15.48086704, S: 0.090521875 },
  83: { L: -3.32687018, M: 15.49637465, S: 0.091323162 },
  84: { L: -3.323188896, M: 15.51286936, S: 0.092131305 },
  85: { L: -3.317827016, M: 15.53033563, S: 0.092945544 },
  86: { L: -3.310923871, M: 15.54875807, S: 0.093765118 },
  87: { L: -3.302612272, M: 15.56812143, S: 0.09458927 },
  88: { L: -3.293018361, M: 15.58841065, S: 0.095417247 },
  89: { L: -3.282260813, M: 15.60961101, S: 0.096248301 },
  90: { L: -3.270454609, M: 15.63170735, S: 0.097081694 },
  91: { L: -3.257703616, M: 15.65468563, S: 0.097916698 },
  92: { L: -3.244108214, M: 15.67853139, S: 0.098752593 },
  93: { L: -3.229761713, M: 15.70323052, S: 0.099588675 },
  94: { L: -3.214751287, M: 15.72876911, S: 0.100424251 },
  95: { L: -3.199158184, M: 15.75513347, S: 0.101258643 },
  96: { L: -3.18305795, M: 15.78231007, S: 0.102091189 },
  97: { L: -3.166520664, M: 15.8102856, S: 0.102921245 },
  98: { L: -3.1496103, M: 15.83904708, S: 0.103748189 },
  99: { L: -3.132389637, M: 15.86858123, S: 0.104571386 },
  100: { L: -3.114911153, M: 15.89887562, S: 0.105390269 },
  101: { L: -3.097226399, M: 15.92991765, S: 0.106204258 },
  102: { L: -3.079383079, M: 15.96169481, S: 0.107012788 },
  103: { L: -3.061423765, M: 15.99419489, S: 0.107815327 },
  104: { L: -3.043386071, M: 16.02740607, S: 0.108611374 },
  105: { L: -3.025310003, M: 16.0613159, S: 0.109400388 },
  106: { L: -3.007225737, M: 16.09591292, S: 0.110181915 },
  107: { L: -2.989164598, M: 16.13118532, S: 0.110955478 },
  108: { L: -2.971148225, M: 16.16712234, S: 0.111720691 },
  109: { L: -2.953208047, M: 16.20371168, S: 0.112477059 },
  110: { L: -2.935363951, M: 16.24094239, S: 0.1132242 },
  111: { L: -2.917635157, M: 16.27880346, S: 0.113961734 },
  112: { L: -2.900039803, M: 16.31728385, S: 0.114689291 },
  113: { L: -2.882593796, M: 16.35637267, S: 0.115406523 },
  114: { L: -2.865311266, M: 16.39605916, S: 0.116113097 },
  115: { L: -2.848204697, M: 16.43633265, S: 0.116808702 },
  116: { L: -2.831285052, M: 16.47718256, S: 0.117493042 },
  117: { L: -2.81456189, M: 16.51859843, S: 0.11816584 },
  118: { L: -2.79804347, M: 16.56056987, S: 0.118826835 },
  119: { L: -2.781736856, M: 16.60308661, S: 0.119475785 },
  120: { L: -2.765648008, M: 16.64613844, S: 0.120112464 },
  121: { L: -2.749782197, M: 16.68971518, S: 0.120736656 },
  122: { L: -2.734142443, M: 16.73380695, S: 0.121348181 },
  123: { L: -2.718732873, M: 16.77840363, S: 0.121946849 },
  124: { L: -2.703555506, M: 16.82349538, S: 0.122532501 },
  125: { L: -2.688611957, M: 16.86907238, S: 0.123104991 },
  126: { L: -2.673903164, M: 16.91512487, S: 0.123664186 },
  127: { L: -2.659429443, M: 16.96164317, S: 0.124209969 },
  128: { L: -2.645190534, M: 17.00861766, S: 0.124742239 },
  129: { L: -2.631185649, M: 17.05603879, S: 0.125260905 },
  130: { L: -2.617413511, M: 17.10389705, S: 0.125765895 },
  131: { L: -2.603872392, M: 17.15218302, S: 0.126257147 },
  132: { L: -2.590560148, M: 17.20088732, S: 0.126734613 },
  133: { L: -2.577474253, M: 17.25000062, S: 0.12719826 },
  134: { L: -2.564611831, M: 17.29951367, S: 0.127648067 },
  135: { L: -2.551969684, M: 17.34941726, S: 0.128084023 },
  136: { L: -2.539539972, M: 17.39970308, S: 0.128506192 },
  137: { L: -2.527325681, M: 17.45036072, S: 0.128914497 },
  138: { L: -2.515320235, M: 17.50138161, S: 0.129309001 },
  139: { L: -2.503519447, M: 17.55275674, S: 0.129689741 },
  140: { L: -2.491918934, M: 17.60447714, S: 0.130056765 },
  141: { L: -2.480514136, M: 17.6565339, S: 0.130410133 },
  142: { L: -2.469300331, M: 17.70891811, S: 0.130749913 },
  143: { L: -2.458272656, M: 17.76162094, S: 0.131076187 },
  144: { L: -2.447426113, M: 17.81463359, S: 0.131389042 },
  145: { L: -2.436755595, M: 17.86794729, S: 0.131688579 },
  146: { L: -2.426255887, M: 17.92155332, S: 0.131974905 },
  147: { L: -2.415921689, M: 17.97544299, S: 0.132248138 },
  148: { L: -2.405747619, M: 18.02960765, S: 0.132508403 },
  149: { L: -2.395728233, M: 18.08403868, S: 0.132755834 },
  150: { L: -2.385858029, M: 18.1387275, S: 0.132990575 },
  151: { L: -2.376131459, M: 18.19366555, S: 0.133212776 },
  152: { L: -2.366542942, M: 18.24884431, S: 0.133422595 },
  153: { L: -2.357086871, M: 18.3042553, S: 0.133620197 },
  154: { L: -2.347757625, M: 18.35989003, S: 0.133805756 },
  155: { L: -2.338549576, M: 18.41574009, S: 0.133979452 },
  156: { L: -2.3294571, M: 18.47179706, S: 0.13414147 },
  157: { L: -2.320474586, M: 18.52805255, S: 0.134292005 },
  158: { L: -2.311596446, M: 18.5844982, S: 0.134431256 },
  159: { L: -2.302817124, M: 18.64112567, S: 0.134559427 },
  160: { L: -2.294131107, M: 18.69792663, S: 0.134676731 },
  161: { L: -2.285532933, M: 18.75489278, S: 0.134783385 },
  162: { L: -2.277017201, M: 18.81201584, S: 0.134879611 },
  163: { L: -2.268578584, M: 18.86928753, S: 0.134965637 },
  164: { L: -2.260211837, M: 18.92669959, S: 0.135041695 },
  165: { L: -2.251911809, M: 18.98424378, S: 0.135108024 },
  166: { L: -2.243673453, M: 19.04191185, S: 0.135164867 },
  167: { L: -2.235491842, M: 19.09969557, S: 0.135212469 },
  168: { L: -2.227362173, M: 19.15758672, S: 0.135251083 },
  169: { L: -2.21927979, M: 19.21557707, S: 0.135280963 },
  170: { L: -2.211240187, M: 19.27365839, S: 0.135302371 },
  171: { L: -2.203239029, M: 19.33182247, S: 0.135315568 },
  172: { L: -2.195272161, M: 19.39006106, S: 0.135320824 },
  173: { L: -2.187335625, M: 19.44836594, S: 0.135318407 },
  174: { L: -2.179425674, M: 19.50672885, S: 0.135308594 },
  175: { L: -2.171538789, M: 19.56514153, S: 0.135291662 },
  176: { L: -2.163671689, M: 19.62359571, S: 0.135267891 },
  177: { L: -2.155821357, M: 19.6820831, S: 0.135237567 },
  178: { L: -2.147985046, M: 19.74059538, S: 0.135200976 },
  179: { L: -2.140160305, M: 19.7991242, S: 0.135158409 },
  180: { L: -2.132344989, M: 19.85766121, S: 0.135110159 },
  181: { L: -2.124537282, M: 19.916198, S: 0.135056522 },
  182: { L: -2.116735712, M: 19.97472615, S: 0.134997797 },
  183: { L: -2.108939167, M: 20.03323719, S: 0.134934285 },
  184: { L: -2.10114692, M: 20.09172262, S: 0.134866291 },
  185: { L: -2.093358637, M: 20.15017387, S: 0.134794121 },
  186: { L: -2.085574403, M: 20.20858236, S: 0.134718085 },
  187: { L: -2.077794735, M: 20.26693944, S: 0.134638494 },
  188: { L: -2.070020599, M: 20.32523642, S: 0.134555663 },
  189: { L: -2.062253431, M: 20.38346455, S: 0.13446991 },
  190: { L: -2.054495145, M: 20.44161501, S: 0.134381553 },
  191: { L: -2.046748156, M: 20.49967894, S: 0.134290916 },
  192: { L: -2.039015385, M: 20.5576474, S: 0.134198323 },
  193: { L: -2.031300282, M: 20.6155114, S: 0.134104101 },
  194: { L: -2.023606828, M: 20.67326189, S: 0.134008581 },
  195: { L: -2.015942013, M: 20.73088905, S: 0.133912066 },
  196: { L: -2.008305745, M: 20.7883851, S: 0.133814954 },
  197: { L: -2.000706389, M: 20.84574003, S: 0.133717552 },
  198: { L: -1.993150137, M: 20.90294449, S: 0.1336202 },
  199: { L: -1.985643741, M: 20.95998909, S: 0.133523244 },
  200: { L: -1.97819451, M: 21.01686433, S: 0.133427032 },
  201: { L: -1.970810308, M: 21.07356067, S: 0.133331914 },
  202: { L: -1.96349954, M: 21.1300685, S: 0.133238245 },
  203: { L: -1.956271141, M: 21.18637813, S: 0.133146383 },
  204: { L: -1.949134561, M: 21.24247982, S: 0.13305669 },
  205: { L: -1.942099744, M: 21.29836376, S: 0.132969531 },
  206: { L: -1.935177101, M: 21.35402009, S: 0.132885274 },
  207: { L: -1.92837748, M: 21.40943891, S: 0.132804292 },
  208: { L: -1.921712136, M: 21.46461026, S: 0.132726962 },
  209: { L: -1.915192685, M: 21.51952414, S: 0.132653664 },
  210: { L: -1.908831065, M: 21.57417053, S: 0.132584784 },
  211: { L: -1.902639482, M: 21.62853937, S: 0.132520711 },
  212: { L: -1.896630358, M: 21.68262062, S: 0.132461838 },
  213: { L: -1.890816268, M: 21.73640419, S: 0.132408563 },
  214: { L: -1.885209876, M: 21.78988003, S: 0.132361289 },
  215: { L: -1.879823505, M: 21.84303819, S: 0.132320427 },
  216: { L: -1.874670324, M: 21.8958685, S: 0.132286382 },
  217: { L: -1.869760299, M: 21.94836168, S: 0.1322596 },
  218: { L: -1.865113245, M: 22.00050569, S: 0.132240418 },
  219: { L: -1.860734944, M: 22.05229242, S: 0.13222933 },
  220: { L: -1.85663384, M: 22.10371305, S: 0.132226801 },
  221: { L: -1.852827186, M: 22.15475603, S: 0.132233201 },
  222: { L: -1.849323204, M: 22.20541249, S: 0.132248993 },
  223: { L: -1.846131607, M: 22.255673, S: 0.132274625 },
  224: { L: -1.843261294, M: 22.30552831, S: 0.132310549 },
  225: { L: -1.840720248, M: 22.3549693, S: 0.132357221 },
  226: { L: -1.83851544, M: 22.40398706, S: 0.132415103 },
  227: { L: -1.83665586, M: 22.45257182, S: 0.132484631 },
  228: { L: -1.835138046, M: 22.50071778, S: 0.132566359 },
  229: { L: -1.833972004, M: 22.54841437, S: 0.132660699 },
  230: { L: -1.833157751, M: 22.59565422, S: 0.132768153 },
  231: { L: -1.83269562, M: 22.64242956, S: 0.132889211 },
  232: { L: -1.832584342, M: 22.68873292, S: 0.133024368 },
  233: { L: -1.832820974, M: 22.73455713, S: 0.133174129 },
  234: { L: -1.833400825, M: 22.7798953, S: 0.133338999 },
  235: { L: -1.834317405, M: 22.82474087, S: 0.133519496 },
  236: { L: -1.83555752, M: 22.86908912, S: 0.133716192 },
  237: { L: -1.837119466, M: 22.91293151, S: 0.133929525 },
  238: { L: -1.838987063, M: 22.95626373, S: 0.134160073 },
  239: { L: -1.841146139, M: 22.99908062, S: 0.134408381 },
  240: { L: -1.841146139, M: 22.99908062, S: 0.134408381 },
};

// ============================================================
// CDC BMI-FOR-AGE: Girls (24-240 months / 2-20 years)
// Source: https://www.cdc.gov/growthcharts/percentile_data_files.htm
// CDCref_d.csv - SEX=2 for girls
// ============================================================
export const bmiForAgeGirls: Record<number, { L: number; M: number; S: number }> = {
  24: { L: -1.024496827, M: 16.38804056, S: 0.085025838 },
  25: { L: -1.102698353, M: 16.3189719, S: 0.084214052 },
  26: { L: -1.18396635, M: 16.25207985, S: 0.083455124 },
  27: { L: -1.268071036, M: 16.18734669, S: 0.082748284 },
  28: { L: -1.354751525, M: 16.12475448, S: 0.082092737 },
  29: { L: -1.443689692, M: 16.06428762, S: 0.081487717 },
  30: { L: -1.53454192, M: 16.00593001, S: 0.080932448 },
  31: { L: -1.626928093, M: 15.94966631, S: 0.080426175 },
  32: { L: -1.720434829, M: 15.89548197, S: 0.079968176 },
  33: { L: -1.814635262, M: 15.84336179, S: 0.079557735 },
  34: { L: -1.909076262, M: 15.79329146, S: 0.079194187 },
  35: { L: -2.003296102, M: 15.7452564, S: 0.078876895 },
  36: { L: -2.096828937, M: 15.69924188, S: 0.078605255 },
  37: { L: -2.189211877, M: 15.65523282, S: 0.078378696 },
  38: { L: -2.279991982, M: 15.61321371, S: 0.078196674 },
  39: { L: -2.368732949, M: 15.57316843, S: 0.078058667 },
  40: { L: -2.455021314, M: 15.53508019, S: 0.077964169 },
  41: { L: -2.538471972, M: 15.49893145, S: 0.077912684 },
  42: { L: -2.618732901, M: 15.46470384, S: 0.077903716 },
  43: { L: -2.695488973, M: 15.43237817, S: 0.077936763 },
  44: { L: -2.768464816, M: 15.40193436, S: 0.078011309 },
  45: { L: -2.837426693, M: 15.37335154, S: 0.078126817 },
  46: { L: -2.902178205, M: 15.34660842, S: 0.078282739 },
  47: { L: -2.962580386, M: 15.32168181, S: 0.078478449 },
  48: { L: -3.018521987, M: 15.29854897, S: 0.078713325 },
  49: { L: -3.069936555, M: 15.27718618, S: 0.078986694 },
  50: { L: -3.116795864, M: 15.2575692, S: 0.079297841 },
  51: { L: -3.159107331, M: 15.23967338, S: 0.079646006 },
  52: { L: -3.196911083, M: 15.22347371, S: 0.080030389 },
  53: { L: -3.230276759, M: 15.20894491, S: 0.080450145 },
  54: { L: -3.259300182, M: 15.19606152, S: 0.080904391 },
  55: { L: -3.284099963, M: 15.18479799, S: 0.081392203 },
  56: { L: -3.30481415, M: 15.17512871, S: 0.081912623 },
  57: { L: -3.321596954, M: 15.16702811, S: 0.082464661 },
  58: { L: -3.334615646, M: 15.16047068, S: 0.083047295 },
  59: { L: -3.344047622, M: 15.15543107, S: 0.083659478 },
  60: { L: -3.35007771, M: 15.15188405, S: 0.084300139 },
  61: { L: -3.352893805, M: 15.14980479, S: 0.0849682 },
  62: { L: -3.352691376, M: 15.14916825, S: 0.085662539 },
  63: { L: -3.34966438, M: 15.14994984, S: 0.086382035 },
  64: { L: -3.343998803, M: 15.15212585, S: 0.087125591 },
  65: { L: -3.335889574, M: 15.15567186, S: 0.087892047 },
  66: { L: -3.325522491, M: 15.16056419, S: 0.088680264 },
  67: { L: -3.31307846, M: 15.16677947, S: 0.089489106 },
  68: { L: -3.298732648, M: 15.17429464, S: 0.090317434 },
  69: { L: -3.282653831, M: 15.18308694, S: 0.091164117 },
  70: { L: -3.265003896, M: 15.1931339, S: 0.092028028 },
  71: { L: -3.245937506, M: 15.20441335, S: 0.092908048 },
  72: { L: -3.225606516, M: 15.21690296, S: 0.093803033 },
  73: { L: -3.204146115, M: 15.2305815, S: 0.094711916 },
  74: { L: -3.181690237, M: 15.24542745, S: 0.095633595 },
  75: { L: -3.158363475, M: 15.26141966, S: 0.096566992 },
  76: { L: -3.134282833, M: 15.27853728, S: 0.097511046 },
  77: { L: -3.109557879, M: 15.29675967, S: 0.09846471 },
  78: { L: -3.084290931, M: 15.31606644, S: 0.099426955 },
  79: { L: -3.058577292, M: 15.33643745, S: 0.100396769 },
  80: { L: -3.032505499, M: 15.35785274, S: 0.101373159 },
  81: { L: -3.0061576, M: 15.38029261, S: 0.10235515 },
  82: { L: -2.979609448, M: 15.40373754, S: 0.103341788 },
  83: { L: -2.952930993, M: 15.42816819, S: 0.104332139 },
  84: { L: -2.926186592, M: 15.45356545, S: 0.105325289 },
  85: { L: -2.899435307, M: 15.47991037, S: 0.106320346 },
  86: { L: -2.872731211, M: 15.50718419, S: 0.10731644 },
  87: { L: -2.846123683, M: 15.53536829, S: 0.108312721 },
  88: { L: -2.819657704, M: 15.56444426, S: 0.109308364 },
  89: { L: -2.793374145, M: 15.5943938, S: 0.110302563 },
  90: { L: -2.767310047, M: 15.6251988, S: 0.111294537 },
  91: { L: -2.741498897, M: 15.65684126, S: 0.112283526 },
  92: { L: -2.715970894, M: 15.68930333, S: 0.113268793 },
  93: { L: -2.690753197, M: 15.7225673, S: 0.114249622 },
  94: { L: -2.665870146, M: 15.75661555, S: 0.115225321 },
  95: { L: -2.641343436, M: 15.79143062, S: 0.116195218 },
  96: { L: -2.617192204, M: 15.82699517, S: 0.117158667 },
  97: { L: -2.593430614, M: 15.86329241, S: 0.118115073 },
  98: { L: -2.570076037, M: 15.90030484, S: 0.119063807 },
  99: { L: -2.547141473, M: 15.93801545, S: 0.12000429 },
  100: { L: -2.524635245, M: 15.97640787, S: 0.120935994 },
  101: { L: -2.502569666, M: 16.01546483, S: 0.121858355 },
  102: { L: -2.48095189, M: 16.05516984, S: 0.12277087 },
  103: { L: -2.459785573, M: 16.09550688, S: 0.123673085 },
  104: { L: -2.439080117, M: 16.13645881, S: 0.124564484 },
  105: { L: -2.418838304, M: 16.17800955, S: 0.125444639 },
  106: { L: -2.399063683, M: 16.22014281, S: 0.126313121 },
  107: { L: -2.379756861, M: 16.26284277, S: 0.127169545 },
  108: { L: -2.360920527, M: 16.30609316, S: 0.128013515 },
  109: { L: -2.342557728, M: 16.34987759, S: 0.128844639 },
  110: { L: -2.324663326, M: 16.39418118, S: 0.129662637 },
  111: { L: -2.307240716, M: 16.43898741, S: 0.130467138 },
  112: { L: -2.290287663, M: 16.48428082, S: 0.131257852 },
  113: { L: -2.273803847, M: 16.53004554, S: 0.132034479 },
  114: { L: -2.257782149, M: 16.57626713, S: 0.132796819 },
  115: { L: -2.242227723, M: 16.62292864, S: 0.133544525 },
  116: { L: -2.227132805, M: 16.67001572, S: 0.134277436 },
  117: { L: -2.212495585, M: 16.71751288, S: 0.134995324 },
  118: { L: -2.19831275, M: 16.76540496, S: 0.135697996 },
  119: { L: -2.184580762, M: 16.81367689, S: 0.136385276 },
  120: { L: -2.171295888, M: 16.86231366, S: 0.137057004 },
  121: { L: -2.158454232, M: 16.91130036, S: 0.137713039 },
  122: { L: -2.146051754, M: 16.96062216, S: 0.138353254 },
  123: { L: -2.134084303, M: 17.0102643, S: 0.138977537 },
  124: { L: -2.122547629, M: 17.06021213, S: 0.139585795 },
  125: { L: -2.111437411, M: 17.11045106, S: 0.140177947 },
  126: { L: -2.100749266, M: 17.16096656, S: 0.140753927 },
  127: { L: -2.090478774, M: 17.21174424, S: 0.141313686 },
  128: { L: -2.080621484, M: 17.26276973, S: 0.141857186 },
  129: { L: -2.071172932, M: 17.31402878, S: 0.142384404 },
  130: { L: -2.062128649, M: 17.3655072, S: 0.142895332 },
  131: { L: -2.053484173, M: 17.4171909, S: 0.143389972 },
  132: { L: -2.045235058, M: 17.46906585, S: 0.143868341 },
  133: { L: -2.03737688, M: 17.52111811, S: 0.144330469 },
  134: { L: -2.029906684, M: 17.57333347, S: 0.144776372 },
  135: { L: -2.022817914, M: 17.62569869, S: 0.145206138 },
  136: { L: -2.016107084, M: 17.67819987, S: 0.145619819 },
  137: { L: -2.009769905, M: 17.7308234, S: 0.146017491 },
  138: { L: -2.003802134, M: 17.78355575, S: 0.146399239 },
  139: { L: -1.998199572, M: 17.83638347, S: 0.146765161 },
  140: { L: -1.992958064, M: 17.88929321, S: 0.147115364 },
  141: { L: -1.988073505, M: 17.94227168, S: 0.147449967 },
  142: { L: -1.983541835, M: 17.9953057, S: 0.147769097 },
  143: { L: -1.979359041, M: 18.04838216, S: 0.148072891 },
  144: { L: -1.975521156, M: 18.10148804, S: 0.148361495 },
  145: { L: -1.972024258, M: 18.15461039, S: 0.148635067 },
  146: { L: -1.968864465, M: 18.20773639, S: 0.148893769 },
  147: { L: -1.966037938, M: 18.26085325, S: 0.149137776 },
  148: { L: -1.963540872, M: 18.31394832, S: 0.14936727 },
  149: { L: -1.961369499, M: 18.36700902, S: 0.149582439 },
  150: { L: -1.959520079, M: 18.42002284, S: 0.149783482 },
  151: { L: -1.9579889, M: 18.47297739, S: 0.149970604 },
  152: { L: -1.956772271, M: 18.52586035, S: 0.15014402 },
  153: { L: -1.95586652, M: 18.57865951, S: 0.15030395 },
  154: { L: -1.955267984, M: 18.63136275, S: 0.150450621 },
  155: { L: -1.954973011, M: 18.68395801, S: 0.15058427 },
  156: { L: -1.954977947, M: 18.73643338, S: 0.150705138 },
  157: { L: -1.955279136, M: 18.788777, S: 0.150813475 },
  158: { L: -1.955872909, M: 18.84097713, S: 0.150909535 },
  159: { L: -1.956755579, M: 18.89302212, S: 0.150993582 },
  160: { L: -1.957923436, M: 18.94490041, S: 0.151065883 },
  161: { L: -1.959372737, M: 18.99660055, S: 0.151126714 },
  162: { L: -1.9610997, M: 19.04811118, S: 0.151176355 },
  163: { L: -1.963100496, M: 19.09942105, S: 0.151215094 },
  164: { L: -1.96537124, M: 19.15051899, S: 0.151243223 },
  165: { L: -1.967907983, M: 19.20139397, S: 0.151261042 },
  166: { L: -1.970706706, M: 19.25203503, S: 0.151268855 },
  167: { L: -1.973763307, M: 19.30243131, S: 0.151266974 },
  168: { L: -1.977073595, M: 19.35257209, S: 0.151255713 },
  169: { L: -1.980633277, M: 19.40244671, S: 0.151235395 },
  170: { L: -1.984437954, M: 19.45204465, S: 0.151206347 },
  171: { L: -1.988483106, M: 19.50135548, S: 0.151168902 },
  172: { L: -1.992764085, M: 19.55036888, S: 0.151123398 },
  173: { L: -1.997276103, M: 19.59907464, S: 0.15107018 },
  174: { L: -2.002014224, M: 19.64746266, S: 0.151009595 },
  175: { L: -2.00697335, M: 19.69552294, S: 0.150942 },
  176: { L: -2.012148213, M: 19.7432456, S: 0.150867753 },
  177: { L: -2.017533363, M: 19.79062086, S: 0.150787221 },
  178: { L: -2.023123159, M: 19.83763907, S: 0.150700774 },
  179: { L: -2.028911755, M: 19.88429066, S: 0.150608788 },
  180: { L: -2.034893091, M: 19.9305662, S: 0.150511645 },
  181: { L: -2.041060881, M: 19.97645636, S: 0.150409731 },
  182: { L: -2.047408604, M: 20.02195192, S: 0.15030344 },
  183: { L: -2.05392949, M: 20.06704377, S: 0.150193169 },
  184: { L: -2.060616513, M: 20.11172291, S: 0.150079322 },
  185: { L: -2.067462375, M: 20.15598047, S: 0.149962308 },
  186: { L: -2.074459502, M: 20.19980767, S: 0.14984254 },
  187: { L: -2.081600029, M: 20.24319586, S: 0.149720441 },
  188: { L: -2.088875793, M: 20.28613648, S: 0.149596434 },
  189: { L: -2.096278323, M: 20.32862109, S: 0.149470953 },
  190: { L: -2.103798828, M: 20.37064138, S: 0.149344433 },
  191: { L: -2.111428194, M: 20.41218911, S: 0.149217319 },
  192: { L: -2.119156972, M: 20.45325617, S: 0.14909006 },
  193: { L: -2.126975375, M: 20.49383457, S: 0.14896311 },
  194: { L: -2.134873266, M: 20.5339164, S: 0.148836931 },
  195: { L: -2.142840157, M: 20.57349387, S: 0.148711989 },
  196: { L: -2.150865204, M: 20.61255929, S: 0.148588757 },
  197: { L: -2.158937201, M: 20.65110506, S: 0.148467715 },
  198: { L: -2.167044578, M: 20.6891237, S: 0.148349348 },
  199: { L: -2.175176987, M: 20.72660728, S: 0.14823412 },
  200: { L: -2.183317362, M: 20.76355011, S: 0.148122614 },
  201: { L: -2.191457792, M: 20.79994337, S: 0.148015249 },
  202: { L: -2.199583649, M: 20.83578051, S: 0.147912564 },
  203: { L: -2.207681525, M: 20.87105449, S: 0.147815078 },
  204: { L: -2.215737645, M: 20.90575839, S: 0.147723315 },
  205: { L: -2.223739902, M: 20.93988477, S: 0.147637768 },
  206: { L: -2.231667995, M: 20.97342858, S: 0.147559083 },
  207: { L: -2.239511942, M: 21.00638171, S: 0.147487716 },
  208: { L: -2.247257081, M: 21.0387374, S: 0.14742421 },
  209: { L: -2.254885145, M: 21.07048996, S: 0.147369174 },
  210: { L: -2.26238209, M: 21.10163241, S: 0.147323144 },
  211: { L: -2.269731517, M: 21.13215845, S: 0.147286698 },
  212: { L: -2.276917229, M: 21.16206171, S: 0.147260415 },
  213: { L: -2.283925442, M: 21.1913351, S: 0.147244828 },
  214: { L: -2.290731442, M: 21.21997472, S: 0.147240683 },
  215: { L: -2.29732427, M: 21.24797262, S: 0.147248467 },
  216: { L: -2.303687802, M: 21.27532239, S: 0.14726877 },
  217: { L: -2.309799971, M: 21.30201933, S: 0.147302299 },
  218: { L: -2.315651874, M: 21.32805489, S: 0.147349514 },
  219: { L: -2.32121731, M: 21.35342563, S: 0.147411215 },
  220: { L: -2.326481911, M: 21.37812462, S: 0.147487979 },
  221: { L: -2.331428139, M: 21.40214589, S: 0.147580453 },
  222: { L: -2.336038473, M: 21.42548351, S: 0.147689289 },
  223: { L: -2.34029545, M: 21.44813156, S: 0.14781515 },
  224: { L: -2.344181703, M: 21.47008412, S: 0.147958706 },
  225: { L: -2.34768, M: 21.49133529, S: 0.148120633 },
  226: { L: -2.350773286, M: 21.51187918, S: 0.148301619 },
  227: { L: -2.353444725, M: 21.53170989, S: 0.148502355 },
  228: { L: -2.355677743, M: 21.55082155, S: 0.148723546 },
  229: { L: -2.35745607, M: 21.56920824, S: 0.148965902 },
  230: { L: -2.358763788, M: 21.58686406, S: 0.149230142 },
  231: { L: -2.359585369, M: 21.60378309, S: 0.149516994 },
  232: { L: -2.359905726, M: 21.61995939, S: 0.149827195 },
  233: { L: -2.359710258, M: 21.635387, S: 0.150161492 },
  234: { L: -2.358980464, M: 21.65006126, S: 0.150520734 },
  235: { L: -2.357714508, M: 21.6639727, S: 0.150905439 },
  236: { L: -2.355892424, M: 21.67711736, S: 0.151316531 },
  237: { L: -2.353501353, M: 21.68948935, S: 0.151754808 },
  238: { L: -2.350528726, M: 21.70108288, S: 0.152221086 },
  239: { L: -2.346962247, M: 21.71189225, S: 0.152716206 },
  240: { L: -2.346962247, M: 21.71189225, S: 0.152716206 },
};

// ============================================================
// WEIGHT-FOR-LENGTH: Boys (45-110 cm)
// Source: WHO Child Growth Standards - Weight-for-length
// https://www.who.int/tools/child-growth-standards/standards/weight-for-length-height
// ============================================================
export const weightForLengthBoys: Record<number, { L: number; M: number; S: number }> = {
  45: { L: -0.3521, M: 2.441, S: 0.09182 },
  46: { L: -0.3521, M: 2.6077, S: 0.09124 },
  47: { L: -0.3521, M: 2.7755, S: 0.09065 },
  48: { L: -0.3521, M: 2.948, S: 0.09007 },
  49: { L: -0.3521, M: 3.1308, S: 0.08948 },
  50: { L: -0.3521, M: 3.3278, S: 0.0889 },
  51: { L: -0.3521, M: 3.5376, S: 0.08831 },
  52: { L: -0.3521, M: 3.762, S: 0.08771 },
  53: { L: -0.3521, M: 4.006, S: 0.08711 },
  54: { L: -0.3521, M: 4.2693, S: 0.08651 },
  55: { L: -0.3521, M: 4.5467, S: 0.08592 },
  56: { L: -0.3521, M: 4.8338, S: 0.08535 },
  57: { L: -0.3521, M: 5.1259, S: 0.08481 },
  58: { L: -0.3521, M: 5.418, S: 0.0843 },
  59: { L: -0.3521, M: 5.7074, S: 0.08383 },
  60: { L: -0.3521, M: 5.9907, S: 0.08342 },
  61: { L: -0.3521, M: 6.2632, S: 0.08308 },
  62: { L: -0.3521, M: 6.5251, S: 0.08279 },
  63: { L: -0.3521, M: 6.7786, S: 0.08255 },
  64: { L: -0.3521, M: 7.0255, S: 0.08236 },
  65: { L: -0.3521, M: 7.2666, S: 0.08223 },
  66: { L: -0.3521, M: 7.5034, S: 0.08215 },
  67: { L: -0.3521, M: 7.737, S: 0.08212 },
  68: { L: -0.3521, M: 7.9674, S: 0.08214 },
  69: { L: -0.3521, M: 8.1955, S: 0.08219 },
  70: { L: -0.3521, M: 8.4227, S: 0.08229 },
  71: { L: -0.3521, M: 8.648, S: 0.08241 },
  72: { L: -0.3521, M: 8.8697, S: 0.08254 },
  73: { L: -0.3521, M: 9.0865, S: 0.08269 },
  74: { L: -0.3521, M: 9.2974, S: 0.08283 },
  75: { L: -0.3521, M: 9.5032, S: 0.08295 },
  76: { L: -0.3521, M: 9.7033, S: 0.08307 },
  77: { L: -0.3521, M: 9.8963, S: 0.08314 },
  78: { L: -0.3521, M: 10.0827, S: 0.08318 },
  79: { L: -0.3521, M: 10.2649, S: 0.08316 },
  80: { L: -0.3521, M: 10.4475, S: 0.08308 },
  81: { L: -0.3521, M: 10.6352, S: 0.08293 },
  82: { L: -0.3521, M: 10.8321, S: 0.08273 },
  83: { L: -0.3521, M: 11.0415, S: 0.08246 },
  84: { L: -0.3521, M: 11.2651, S: 0.08215 },
  85: { L: -0.3521, M: 11.5007, S: 0.08181 },
  86: { L: -0.3521, M: 11.7444, S: 0.08145 },
  87: { L: -0.3521, M: 11.9916, S: 0.08111 },
  88: { L: -0.3521, M: 12.2382, S: 0.08082 },
  89: { L: -0.3521, M: 12.4815, S: 0.08058 },
  90: { L: -0.3521, M: 12.7209, S: 0.08041 },
  91: { L: -0.3521, M: 12.9569, S: 0.0803 },
  92: { L: -0.3521, M: 13.191, S: 0.08025 },
  93: { L: -0.3521, M: 13.4239, S: 0.08026 },
  94: { L: -0.3521, M: 13.6572, S: 0.08034 },
  95: { L: -0.3521, M: 13.8928, S: 0.08047 },
  96: { L: -0.3521, M: 14.1325, S: 0.08067 },
  97: { L: -0.3521, M: 14.3782, S: 0.08092 },
  98: { L: -0.3521, M: 14.6316, S: 0.08122 },
  99: { L: -0.3521, M: 14.8934, S: 0.08157 },
  100: { L: -0.3521, M: 15.1637, S: 0.08198 },
  101: { L: -0.3521, M: 15.4419, S: 0.08243 },
  102: { L: -0.3521, M: 15.7276, S: 0.08292 },
  103: { L: -0.3521, M: 16.0206, S: 0.08343 },
  104: { L: -0.3521, M: 16.3204, S: 0.08397 },
  105: { L: -0.3521, M: 16.6268, S: 0.08453 },
  106: { L: -0.3521, M: 16.9401, S: 0.0851 },
  107: { L: -0.3521, M: 17.2607, S: 0.08568 },
  108: { L: -0.3521, M: 17.5885, S: 0.08629 },
  109: { L: -0.3521, M: 17.9242, S: 0.08691 },
  110: { L: -0.3521, M: 18.2689, S: 0.08755 },
};

// ============================================================
// WEIGHT-FOR-LENGTH: Girls (45-110 cm)
// Source: WHO Child Growth Standards - Weight-for-length
// https://www.who.int/tools/child-growth-standards/standards/weight-for-length-height
// ============================================================
export const weightForLengthGirls: Record<number, { L: number; M: number; S: number }> = {
  45: { L: -0.3833, M: 2.4607, S: 0.09029 },
  46: { L: -0.3833, M: 2.6306, S: 0.09037 },
  47: { L: -0.3833, M: 2.8007, S: 0.09044 },
  48: { L: -0.3833, M: 2.9741, S: 0.09052 },
  49: { L: -0.3833, M: 3.156, S: 0.0906 },
  50: { L: -0.3833, M: 3.3518, S: 0.09068 },
  51: { L: -0.3833, M: 3.5636, S: 0.09076 },
  52: { L: -0.3833, M: 3.7911, S: 0.09085 },
  53: { L: -0.3833, M: 4.0332, S: 0.09093 },
  54: { L: -0.3833, M: 4.2875, S: 0.09102 },
  55: { L: -0.3833, M: 4.5498, S: 0.0911 },
  56: { L: -0.3833, M: 4.8162, S: 0.09118 },
  57: { L: -0.3833, M: 5.0837, S: 0.09125 },
  58: { L: -0.3833, M: 5.3507, S: 0.0913 },
  59: { L: -0.3833, M: 5.6151, S: 0.09134 },
  60: { L: -0.3833, M: 5.8742, S: 0.09136 },
  61: { L: -0.3833, M: 6.127, S: 0.09137 },
  62: { L: -0.3833, M: 6.3738, S: 0.09135 },
  63: { L: -0.3833, M: 6.6144, S: 0.09131 },
  64: { L: -0.3833, M: 6.8501, S: 0.09126 },
  65: { L: -0.3833, M: 7.0812, S: 0.09119 },
  66: { L: -0.3833, M: 7.3076, S: 0.0911 },
  67: { L: -0.3833, M: 7.5288, S: 0.09101 },
  68: { L: -0.3833, M: 7.7448, S: 0.0909 },
  69: { L: -0.3833, M: 7.9559, S: 0.09079 },
  70: { L: -0.3833, M: 8.163, S: 0.09068 },
  71: { L: -0.3833, M: 8.3666, S: 0.09056 },
  72: { L: -0.3833, M: 8.5679, S: 0.09043 },
  73: { L: -0.3833, M: 8.7661, S: 0.09031 },
  74: { L: -0.3833, M: 8.9601, S: 0.09018 },
  75: { L: -0.3833, M: 9.149, S: 0.09005 },
  76: { L: -0.3833, M: 9.3337, S: 0.08992 },
  77: { L: -0.3833, M: 9.5166, S: 0.08979 },
  78: { L: -0.3833, M: 9.7015, S: 0.08965 },
  79: { L: -0.3833, M: 9.8915, S: 0.08952 },
  80: { L: -0.3833, M: 10.0891, S: 0.0894 },
  81: { L: -0.3833, M: 10.2965, S: 0.08928 },
  82: { L: -0.3833, M: 10.514, S: 0.08918 },
  83: { L: -0.3833, M: 10.741, S: 0.0891 },
  84: { L: -0.3833, M: 10.9767, S: 0.08903 },
  85: { L: -0.3833, M: 11.2198, S: 0.08898 },
  86: { L: -0.3833, M: 11.4684, S: 0.08895 },
  87: { L: -0.3833, M: 11.7201, S: 0.08895 },
  88: { L: -0.3833, M: 11.972, S: 0.08896 },
  89: { L: -0.3833, M: 12.2229, S: 0.089 },
  90: { L: -0.3833, M: 12.4723, S: 0.08906 },
  91: { L: -0.3833, M: 12.7205, S: 0.08913 },
  92: { L: -0.3833, M: 12.9681, S: 0.08923 },
  93: { L: -0.3833, M: 13.2158, S: 0.08934 },
  94: { L: -0.3833, M: 13.4643, S: 0.08948 },
  95: { L: -0.3833, M: 13.7146, S: 0.08963 },
  96: { L: -0.3833, M: 13.9676, S: 0.08981 },
  97: { L: -0.3833, M: 14.2239, S: 0.09 },
  98: { L: -0.3833, M: 14.4848, S: 0.09021 },
  99: { L: -0.3833, M: 14.7519, S: 0.09044 },
  100: { L: -0.3833, M: 15.0267, S: 0.09069 },
  101: { L: -0.3833, M: 15.3108, S: 0.09096 },
  102: { L: -0.3833, M: 15.6046, S: 0.09125 },
  103: { L: -0.3833, M: 15.9087, S: 0.09155 },
  104: { L: -0.3833, M: 16.2229, S: 0.09186 },
  105: { L: -0.3833, M: 16.547, S: 0.09219 },
  106: { L: -0.3833, M: 16.8814, S: 0.09254 },
  107: { L: -0.3833, M: 17.2269, S: 0.09289 },
  108: { L: -0.3833, M: 17.5839, S: 0.09326 },
  109: { L: -0.3833, M: 17.9526, S: 0.09363 },
  110: { L: -0.3833, M: 18.3324, S: 0.09401 },
};

// ============================================================
// HELPER FUNCTIONS
// ============================================================

/**
 * Linear interpolation for LMS values between two data points
 */
function interpolateLMS(
  data: Record<number, { L: number; M: number; S: number }>,
  value: number
): { L: number; M: number; S: number } {
  const keys = Object.keys(data).map(Number).sort((a, b) => a - b);
  
  // Exact match
  if (data[value]) {
    return data[value];
  }
  
  // Find surrounding keys
  let lower = keys[0];
  let upper = keys[keys.length - 1];
  
  for (let i = 0; i < keys.length - 1; i++) {
    if (keys[i] <= value && keys[i + 1] >= value) {
      lower = keys[i];
      upper = keys[i + 1];
      break;
    }
  }
  
  // Clamp to range
  if (value <= lower) {
    return data[lower];
  }
  if (value >= upper) {
    return data[upper];
  }
  
  // Linear interpolation
  const ratio = (value - lower) / (upper - lower);
  const lowerLMS = data[lower];
  const upperLMS = data[upper];
  
  return {
    L: lowerLMS.L + ratio * (upperLMS.L - lowerLMS.L),
    M: lowerLMS.M + ratio * (upperLMS.M - lowerLMS.M),
    S: lowerLMS.S + ratio * (upperLMS.S - lowerLMS.S),
  };
}

/**
 * Calculate Z-score using WHO/CDC LMS method
 * Formula: Z = ((X/M)^L - 1) / (L × S), when L ≠ 0
 * Formula: Z = ln(X/M) / S, when L = 0
 */
export function calculateZScore(
  measurement: number,
  L: number,
  M: number,
  S: number
): number {
  if (measurement <= 0 || M <= 0 || S <= 0) {
    return 0;
  }
  
  if (Math.abs(L) < 0.0001) {
    // L is essentially 0, use logarithmic formula
    return Math.log(measurement / M) / S;
  }
  
  // Standard LMS formula
  return (Math.pow(measurement / M, L) - 1) / (L * S);
}

/**
 * Calculate measurement value at a given Z-score (inverse formula)
 * X = M × (1 + L × S × Z)^(1/L), when L ≠ 0
 * X = M × exp(S × Z), when L = 0
 */
export function calculateValueAtZScore(
  zscore: number,
  L: number,
  M: number,
  S: number
): number {
  if (Math.abs(L) < 0.0001) {
    return M * Math.exp(S * zscore);
  }
  return M * Math.pow(1 + L * S * zscore, 1 / L);
}

/**
 * Restrict extreme Z-scores using WHO method
 * For |z| > 3, calculate using fixed SD3 width
 */
export function restrictZScore(
  zscore: number,
  measurement: number,
  L: number,
  M: number,
  S: number
): number {
  if (zscore > 3) {
    const SD3 = calculateValueAtZScore(3, L, M, S);
    const SD2 = calculateValueAtZScore(2, L, M, S);
    const SD3width = SD3 - SD2;
    return 3 + (measurement - SD3) / SD3width;
  }
  if (zscore < -3) {
    const SD3neg = calculateValueAtZScore(-3, L, M, S);
    const SD2neg = calculateValueAtZScore(-2, L, M, S);
    const SD3width = SD2neg - SD3neg;
    return -3 + (measurement - SD3neg) / SD3width;
  }
  return zscore;
}

/**
 * Convert Z-score to percentile using standard normal CDF
 * Uses Abramowitz and Stegun approximation (formula 26.2.17)
 */
export function zScoreToPercentile(zscore: number): number {
  const a1 = 0.254829592;
  const a2 = -0.284496736;
  const a3 = 1.421413741;
  const a4 = -1.453152027;
  const a5 = 1.061405429;
  const p = 0.3275911;
  
  const sign = zscore < 0 ? -1 : 1;
  const z = Math.abs(zscore) / Math.sqrt(2);
  const t = 1 / (1 + p * z);
  const erf = 1 - ((((a5 * t + a4) * t + a3) * t + a2) * t + a1) * t * Math.exp(-z * z);
  
  return (0.5 * (1 + sign * erf)) * 100;
}

/**
 * Calculate BMI
 */
export function calculateBMI(weightKg: number, heightCm: number): number {
  if (heightCm <= 0 || weightKg <= 0) return 0;
  const heightM = heightCm / 100;
  return weightKg / (heightM * heightM);
}

/**
 * BMI Category based on CDC percentile criteria for children 2-20 years
 * https://www.cdc.gov/bmi/child-teen-calculator/index.html
 */
export type BMICategory = 
  | 'underweight'       // <5th percentile
  | 'healthy'           // 5th to <85th percentile
  | 'overweight'        // 85th to <95th percentile
  | 'obesity'           // ≥95th percentile
  | 'severe-obesity';   // ≥120% of 95th percentile OR BMI ≥35

export interface BMIResult {
  bmi: number;
  zScore: number;
  percentile: number;
  category: BMICategory;
  color: string;
}

/**
 * Calculate 95th percentile BMI for given LMS values
 */
function calculate95thPercentileBMI(L: number, M: number, S: number): number {
  // 95th percentile corresponds to z-score of 1.645
  const z95 = 1.6449;
  return calculateValueAtZScore(z95, L, M, S);
}

/**
 * Calculate BMI-for-age z-score and category using CDC LMS method
 * Only valid for ages 24-240 months (2-20 years)
 * 
 * @param bmi - Calculated BMI value
 * @param ageInMonths - Age in months (must be 24-240)
 * @param gender - 'male' or 'female'
 * @returns BMIResult or null if age is outside valid range
 */
export function calculateBMIForAge(
  bmi: number,
  ageInMonths: number,
  gender: 'male' | 'female'
): BMIResult | null {
  // BMI-for-age is only valid for ages 2-20 years (24-240 months)
  if (ageInMonths < 24 || ageInMonths > 240) {
    return null;
  }
  
  if (bmi <= 0) {
    return null;
  }
  
  // Select appropriate LMS data
  const bmiData = gender === 'male' ? bmiForAgeBoys : bmiForAgeGirls;
  
  // Interpolate LMS values
  const lms = interpolateLMS(bmiData, ageInMonths);
  
  // Calculate z-score
  const rawZ = calculateZScore(bmi, lms.L, lms.M, lms.S);
  const zScore = restrictZScore(rawZ, bmi, lms.L, lms.M, lms.S);
  
  // Calculate percentile
  const percentile = zScoreToPercentile(zScore);
  
  // Calculate 95th percentile BMI for severe obesity check
  const bmi95th = calculate95thPercentileBMI(lms.L, lms.M, lms.S);
  
  // Determine category based on CDC criteria
  let category: BMICategory;
  let color: string;
  
  // Severe obesity: ≥120% of 95th percentile OR BMI ≥35
  if (bmi >= bmi95th * 1.2 || bmi >= 35) {
    category = 'severe-obesity';
    color = '#8B0000'; // Dark red
  } else if (percentile >= 95) {
    category = 'obesity';
    color = '#D32F2F'; // Red
  } else if (percentile >= 85) {
    category = 'overweight';
    color = '#F57C00'; // Orange
  } else if (percentile >= 5) {
    category = 'healthy';
    color = '#388E3C'; // Green
  } else {
    category = 'underweight';
    color = '#1976D2'; // Blue
  }
  
  return {
    bmi,
    zScore,
    percentile,
    category,
    color,
  };
}

/**
 * Interpret Z-score results with status and color
 */
export function interpretZScore(zscore: number): {
  status: 'severely-low' | 'low' | 'normal' | 'high' | 'severely-high';
  color: string;
} {
  if (zscore < -3) {
    return { status: 'severely-low', color: '#D32F2F' }; // Red
  } else if (zscore < -2) {
    return { status: 'low', color: '#F57C00' }; // Orange
  } else if (zscore <= 2) {
    return { status: 'normal', color: '#388E3C' }; // Green
  } else if (zscore <= 3) {
    return { status: 'high', color: '#F57C00' }; // Orange
  } else {
    return { status: 'severely-high', color: '#D32F2F' }; // Red
  }
}

// ============================================================
// CALCULATION RESULT INTERFACE
// ============================================================
export interface CalculationResult {
  ageInDays: number;
  ageInMonths: number;
  
  // Length/Height for age
  lengthZScore?: number;
  lengthPercentile?: number;
  lengthStatus?: string;
  lengthColor?: string;
  
  // Weight for age
  weightZScore?: number;
  weightPercentile?: number;
  weightStatus?: string;
  weightColor?: string;
  
  // Weight for length
  weightForLengthZScore?: number;
  weightForLengthPercentile?: number;
  weightForLengthStatus?: string;
  weightForLengthColor?: string;
  
  // Head circumference for age
  headCircZScore?: number;
  headCircPercentile?: number;
  headCircStatus?: string;
  headCircColor?: string;
  
  // BMI (raw calculation)
  bmi?: number;
  
  // BMI-for-age (CDC, only for ages 2-20 years)
  bmiZScore?: number;
  bmiPercentile?: number;
  bmiCategory?: BMICategory;
  bmiColor?: string;
}

// ============================================================
// MAIN CALCULATION FUNCTION
// ============================================================
export function calculateChildGrowth(
  birthDate: Date,
  measurementDate: Date,
  gender: 'male' | 'female',
  lengthCm: number,
  weightKg: number,
  headCircCm: number
): CalculationResult {
  // Calculate age in days
  const birth = new Date(Date.UTC(birthDate.getFullYear(), birthDate.getMonth(), birthDate.getDate()));
  const measurement = new Date(Date.UTC(measurementDate.getFullYear(), measurementDate.getMonth(), measurementDate.getDate()));
  const ageInDays = Math.round((measurement.getTime() - birth.getTime()) / (1000 * 60 * 60 * 24));
  
  // Calculate age in months (for LMS lookup)
  // WHO uses age at half month point, e.g., 1.5 months = 1.0-1.99 months
  const ageInMonths = ageInDays / 30.4375;
  
  const result: CalculationResult = {
    ageInDays,
    ageInMonths,
  };
  
  // WHO data covers 0-24 months
  const maxMonths = 24;
  
  // Length-for-age (0-24 months)
  if (lengthCm > 0 && ageInMonths >= 0 && ageInMonths <= maxMonths) {
    const lengthData = gender === 'male' ? lengthForAgeBoys : lengthForAgeGirls;
    const lms = interpolateLMS(lengthData, ageInMonths);
    const rawZ = calculateZScore(lengthCm, lms.L, lms.M, lms.S);
    result.lengthZScore = restrictZScore(rawZ, lengthCm, lms.L, lms.M, lms.S);
    result.lengthPercentile = zScoreToPercentile(result.lengthZScore);
    const interpretation = interpretZScore(result.lengthZScore);
    result.lengthStatus = interpretation.status;
    result.lengthColor = interpretation.color;
  }
  
  // Weight-for-age (0-24 months)
  if (weightKg > 0 && ageInMonths >= 0 && ageInMonths <= maxMonths) {
    const weightData = gender === 'male' ? weightForAgeBoys : weightForAgeGirls;
    const lms = interpolateLMS(weightData, ageInMonths);
    const rawZ = calculateZScore(weightKg, lms.L, lms.M, lms.S);
    result.weightZScore = restrictZScore(rawZ, weightKg, lms.L, lms.M, lms.S);
    result.weightPercentile = zScoreToPercentile(result.weightZScore);
    const interpretation = interpretZScore(result.weightZScore);
    result.weightStatus = interpretation.status;
    result.weightColor = interpretation.color;
  }
  
  // Weight-for-length (45-110 cm)
  if (weightKg > 0 && lengthCm >= 45 && lengthCm <= 110) {
    const wflData = gender === 'male' ? weightForLengthBoys : weightForLengthGirls;
    const lms = interpolateLMS(wflData, lengthCm);
    const rawZ = calculateZScore(weightKg, lms.L, lms.M, lms.S);
    result.weightForLengthZScore = restrictZScore(rawZ, weightKg, lms.L, lms.M, lms.S);
    result.weightForLengthPercentile = zScoreToPercentile(result.weightForLengthZScore);
    const interpretation = interpretZScore(result.weightForLengthZScore);
    result.weightForLengthStatus = interpretation.status;
    result.weightForLengthColor = interpretation.color;
  }
  
  // Head circumference-for-age (0-24 months)
  if (headCircCm > 0 && ageInMonths >= 0 && ageInMonths <= maxMonths) {
    const headCircData = gender === 'male' ? headCircForAgeBoys : headCircForAgeGirls;
    const lms = interpolateLMS(headCircData, ageInMonths);
    const rawZ = calculateZScore(headCircCm, lms.L, lms.M, lms.S);
    result.headCircZScore = restrictZScore(rawZ, headCircCm, lms.L, lms.M, lms.S);
    result.headCircPercentile = zScoreToPercentile(result.headCircZScore);
    const interpretation = interpretZScore(result.headCircZScore);
    result.headCircStatus = interpretation.status;
    result.headCircColor = interpretation.color;
  }
  
  // Calculate BMI
  if (weightKg > 0 && lengthCm > 0) {
    result.bmi = calculateBMI(weightKg, lengthCm);
    
    // Calculate BMI-for-age for children 2-20 years (24-240 months)
    const bmiResult = calculateBMIForAge(result.bmi, ageInMonths, gender);
    if (bmiResult) {
      result.bmiZScore = bmiResult.zScore;
      result.bmiPercentile = bmiResult.percentile;
      result.bmiCategory = bmiResult.category;
      result.bmiColor = bmiResult.color;
    }
  }
  
  return result;
}

// ============================================================
// CHART DATA GENERATION
// ============================================================
export function generateGrowthCurveData(
  gender: 'male' | 'female',
  chartType: 'length' | 'weight' | 'headCirc'
): { age: number; median: number; sd1: number; sd2: number; sd3: number; sd1neg: number; sd2neg: number; sd3neg: number }[] {
  let data: Record<number, { L: number; M: number; S: number }>;
  
  switch (chartType) {
    case 'length':
      data = gender === 'male' ? lengthForAgeBoys : lengthForAgeGirls;
      break;
    case 'weight':
      data = gender === 'male' ? weightForAgeBoys : weightForAgeGirls;
      break;
    case 'headCirc':
      data = gender === 'male' ? headCircForAgeBoys : headCircForAgeGirls;
      break;
  }
  
  return Object.entries(data).map(([age, lms]) => {
    const ageNum = parseInt(age);
    const { L, M, S } = lms;
    
    return {
      age: ageNum,
      median: M,
      sd1: calculateValueAtZScore(1, L, M, S),
      sd2: calculateValueAtZScore(2, L, M, S),
      sd3: calculateValueAtZScore(3, L, M, S),
      sd1neg: calculateValueAtZScore(-1, L, M, S),
      sd2neg: calculateValueAtZScore(-2, L, M, S),
      sd3neg: calculateValueAtZScore(-3, L, M, S),
    };
  }).sort((a, b) => a.age - b.age);
}

// Export old names for backward compatibility
export const heightForAgeBoys = lengthForAgeBoys;
export const heightForAgeGirls = lengthForAgeGirls;
